<!doctype html>
<html lang="da-DK">
<head>
	<meta http-equiv="x-ua-compatible" content="IE=edge">
	<meta charset="utf-8" />
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta name="format-detection" content="telephone=no" />

	<title th:text="#{html.pin.registration.title}"></title>

	<link rel="stylesheet" th:href="@{/css/app.css}" />
	<link rel="stylesheet" th:href="@{/css/register.css}" />
	<link rel="stylesheet" th:href="@{/libs/fontawesome-5.3.1/css/all.min.css}" />
	<link rel="stylesheet" th:href="@{/libs/bootstrap/css/bootstrap.min.css}" />
	<link rel="stylesheet" th:href="@{/libs/bootstrap/css/bootstrap4-buttons.css}" />
	<link rel="stylesheet" th:href="@{/libs/sweetalert/css/sweetalert2.min.css}" />
</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
		<a class="navbar-brand" href="#">
			<img class="img-fluid" src="/img/os2faktor.png" style="display: inline; max-width: 30vw; max-height: 40px;" />
		</a>
		
		<button class="navbar-toggler" type="button" onclick="closeWindow();">
			<span class="fa fa-times"></span>
		</button>
	</nav>

	<div id="register">
		<form class="form-register" method="post" th:action="@{/ui/pin/register}" th:object="${registration}">
			<div class="form-group" style="margin-top: 10px; font-size: smaller;">
				<h4>Vælg en pinkode</h4>
				<span>Bemærk: Simple pinkoder er ikke lovlige, fx. 0000, 1111, 1234</span> 
			</div>

			<div class="form-group" style="margin-top: 10px;">
				<input type="number" pattern="[0-9]*" inputmode="numeric" style="text-security: disc; -webkit-text-security:disc; -mox-text-security: disc;" maxlength="4" id="inputPin" placeholder="Indtast 4-cifret pinkode" th:field="*{pin}" class="form-control"
					oninput="this.setCustomValidity('')" required="required" oninvalid="this.setCustomValidity('Ugyldig pinkode')" autofocus="autofocus" />
					<ul th:if="${#fields.hasErrors('pin')}">
						<li th:each="err : ${#fields.errors('pin')}" th:text="${err}"></li>
					</ul>
			</div>

			<div class="form-group" style="margin-top: 10px;">
				<input type="number" pattern="[0-9]*" inputmode="numeric" style="text-security: disc; -webkit-text-security:disc; -mox-text-security: disc;" maxlength="4" id="inputConfirm" placeholder="Gentag 4-cifret pinkode" th:field="*{confirm}" class="form-control"
					oninput="this.setCustomValidity('')" required="required" oninvalid="this.setCustomValidity('Ugyldig pinkode')" />
					<ul th:if="${#fields.hasErrors('confirm')}">
						<li th:each="err : ${#fields.errors('confirm')}" th:text="${err}"></li>
					</ul>
			</div>

			<center>
				<button class="btn btn-lg btn-primary" type="submit" th:text="#{html.pin.registration.submit}"></button>
			</center>
		</form>
	</div>
	
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
	<![endif]-->
	
	<script type="text/javascript" th:src="@{/libs/jquery/js/jquery-3.3.1.min.js}"></script>
	<script type="text/javascript" th:src="@{/libs/bootstrap/js/bootstrap.min.js}"></script>
	<script type="text/javascript" th:src="@{/libs/sweetalert/js/sweetalert2.all.min.js}"></script>
	<script type="text/javascript" th:src="@{/libs/promises/js/promise-polyfill.js}"></script>

	<script th:inline="javascript">
		/*<![CDATA[*/

		/*[+
			var url = [[@{/ui/pin/successPage}]];
		+]*/

		function closeWindow() {
			var endpoint = url + "?closeWindow=true";
			window.location = endpoint;
		}

		window.onload = function() {
			init();
		}

		function init() {
			var inputPin = document.getElementById("inputPin");
			var inputConfirm = document.getElementById("inputConfirm");
			var style = window.getComputedStyle(inputPin);

			if (style.webkitTextSecurity) {
				//do nothing
			} else {
				inputPin.setAttribute("type","password");
				inputConfirm.setAttribute("type","password");
			}
		}

		/*]]>*/

	</script>
</body>
</html>